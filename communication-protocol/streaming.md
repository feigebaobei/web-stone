# 流是什么？
从服务器到客户端持续传传输数据的方式。  
常用于video/audio.  
可以一边下载，一边使用。  

# 流是如何工作的？
把一个数据包分为若干小片，从服务器传给客户端，由客户端整理后使用。  

# udp(user datagram protocol)/tcp(transmission control protocol)是如何使用流的？
有些流使用udp，有些流使用tcp。  
udp/tcp都是传输协议。都是基于ip的。  
tcp协议会开通一个通道，依次接收数据包的小片。  
udp...  
tcp更可靠。  
hls、MPEG-DASH使用tcp。  

# 什么是buffering?
预先加载的一段数据就是buffering。它可以使用视频播放平滑。  

# 什么因素影响流传输的速度。
- 服务端
  - 网络延迟  
  - 网络阻塞  
- 客户端  
  - 网络波动  
  - 带宽不够  
  - 客户端硬件性能低  

# 如何让流传输更快？
使用cdn，把内容放在距离用户近的地方。  
cloudflare cdn就是其中一个cdn.  

# 直播流是什么？
实时地发送全部流视频。不记录也不保存。TV直播、游戏直播等都使用直播流。  

|流|直播流||
|-|-|-|
|创建、存储然后传递给受众|创建后立即给受众||  

有可能需要实现1:n。  
常用于rtc(real-time communication)  

# 技术上如何使用直播流？
## 主要步骤
- 压缩  
- 编码  
- 打成碎片  
- 分发  
- 使用cdn分发  
- cdn缓存  
- 解码  
- 视频重播

## video capture
使用camera等设备把视频数据处理为数字数据。最深层的数字数据是0和1.  

## 压缩和编码
编码格式：
- H.264  
- H.265  
- VP9  
- AV1  

## 碎片
把一个完整的视频分为几秒一个小片的若干小片。  

## cdn分发 & 缓存
使用最小延迟的cdn给受众发送数据。  
cdn是把缓存了内容的服务分布在网络中。cdn就是缓存。  
rtt:从发送者到接收者的时间。  

## 解码 & video playback
接收者经过解码、解压、把数字数据转换为视频数据、显示出来。  
带宽（频宽）：频带宽度。  

# 为什么cdn对于直播流很重要？
- 带宽有限  
- cdn可以实现全球内容分发  
- 减少延迟和rtt  
- 减少源服务器的工作载荷  
- 可以缓存数据  

# cloudflare如何促进直播流的？
cloudflare是美国的一家跨国企业。

# 如何缓存流？
cdn把从源服务器得到的数据缓存起来，在有请求时从缓存中取出数据给请求者。  

# 如何缓存直播流？
cdn从源服务器中取得数据，然后缓存起来（视频片段）。当有请求者向cdn请求时，cdn从缓存取出视频片段给请求者。  
大多数视频查看器会缓存几秒视频片段。  

# hls(http实时流)是什么
同时适用于点播流和实时流。HLS 将视频文件分解为较小的可下载 HTTP 文件，并使用 HTTP 协议来交付。客户端设备加载这些 HTTP 文件，然后将它们作为视频进行播放。  
HLS 的一个优点是，所有连入互联网的设备都支持 HTTP，因而它比需要使用专用服务器的流协议更易于实施。另一个优点是 HLS 流可以根据网络状况提高或降低视频质量，而不会中断播放。这就是在用户观看视频的过程中视频质量可能会变好或变差的原因。   
HLS 由 Apple 为 Apple 产品开发，但现在已广泛用于许多设备。  

# hls如何工作？
服务器：HLS 流源自于服务器，其中存储了媒体文件（在点播流式传输中）或创建了流（在实时流式传输中）。因为 HLS 基于HTTP，所以任何普通的 Web 服务器都可以发起流。
- 编码  
- 分段。一般为几秒一段。默认6秒一段。  
  - 创建视频片段的索引文件。  
  - 创建几组不同质量等级的重复片段。  
内容交付网络（CDN）可以协助将流分发到地理上不同的区域。CDN 还可以缓存流，从而更快地将其提供给客户端。  

# 什么是 HLS 自适应比特率流式传输？
指根据网络条件变化而在流的中间调整视频质量的能力。  
因为 HLS 在分段过程中创建了多个不同质量级别的重复流片段。用户的视频播放器可以在视频播放期间从这些流之一切换到另一个流。  

# HLS 是否使用 TCP 或 UDP 作为其传输协议？
HLS 使用 TCP  
hls基于http,http基于tcp.原因：  
- HLS 基于 HTTP，并且 HTTP 协议设计为与 TCP 搭配使用（也有一些例外）。
- 现代 Internet 比最初开发流式传输时更加可靠，更加高效。在当今世界的许多地方，用户连接已得到极大改善，尤其是移动连接。因此，用户有足够的带宽来支持每个视频帧的交付。  
- 自适应比特率流式传输有助于补偿 TCP 潜在的较慢数据交付。  
- HLS 流式传输并不必须“实时”，例如在视频会议连接中。多几秒的延迟不会像丢失视频帧那样严重影响用户体验。  

# 流式传输通常还使用其他哪些协议？
- MPEG-DASH  
- HDS  

adobe flash 是基于RTMP协议的。  

# manifest file是什么？

视频的清单文件告诉播放视频的客户端设备(如用户的笔记本电脑或智能手机)如何按顺序组装视频片段、如何加载音频文件、在哪里存储字幕，等等。这允许客户端设备正确地构造和播放视频。

# HLS vs. HDS: What is the difference?
|hls|hds|
|-|-|
|apple制定的|adobe制定的|

# 什么是 MPEG-DASH？
是一种流式传输。流式传输是一种通过互联网传输数据的方式。  

# MPEG-DASH 如何工作？
1. 编码和分割  
2. 交付  
3. 解码和回话  

# HLS 与 DASH：主要区别是什么？
|hls|dash|
|-|-|
|基于http|基于http|
|H.264/H.265|允许任何编码标准|
|唯一受 Apple 设备支持的格式。iPhone、MacBook 和其他 Apple 产品无法播放通过MPEG-DASH 传输的视频。|-|
|2016年前片段默认长度是10s，其后默认长度是6s。可以设置为指定的片段时长。|通常在2-10s之间。最佳长度是2-4s。|
|Apple 开发，尽管得到了广泛的支持，并没有发布为国际标准。|一种国际标准|