import{f as Ie,m as ge,e as we,d as Le,b as M,E as D,u as Ee,j as ze,i as Se,h as le}from"./axios.54c8cef7.js";import{i as xe,x as N,E as ye,p as re,I as de,O as fe,bo as me,bp as $e,bq as Oe,W as he,H as L,br as Te,X as Ne,q as E,w as ie,$ as be,u as ve,a4 as p,ab as te,ag as v,ac as I,aa as y,a8 as w,F as e,ai as Ae,a6 as z,ae as O,aG as Be,a5 as h,bs as Re,bt as De,a7 as P,bu as Me,a_ as Fe,ad as Ve,bv as He,bw as Xe,aS as ue,a2 as Ye,a3 as Pe,al as ce,a9 as ee,aq as We,aA as je,am as _e,bx as qe,ao as ke,P as Ze,af as Ge,aw as Ke,N as Ue,ak as Ce,by as Je,bz as Qe,as as et,b4 as tt,az as pe}from"./index.65b70abd.js";var at="Expected a function";function oe(o,m,s){var l=!0,u=!0;if(typeof o!="function")throw new TypeError(at);return xe(s)&&(l="leading"in s?!!s.leading:l,u="trailing"in s?!!s.trailing:u),Ie(o,m,{leading:l,maxWait:m,trailing:u})}const nt=(o,m)=>{if(!N||!o||!m)return!1;const s=o.getBoundingClientRect();let l;return m instanceof Element?l=m.getBoundingClientRect():l={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<l.bottom&&s.bottom>l.top&&s.right>l.left&&s.left<l.right},st=()=>N&&/firefox/i.test(window.navigator.userAgent),lt=ye({urlList:{type:re(Array),default:()=>ge([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),ot={close:()=>!0,switch:o=>de(o)},rt=["src"],it={name:"ElImageViewer"},ut=fe({...it,props:lt,emits:ot,setup(o,{expose:m,emit:s}){const l=o,u={CONTAIN:{name:"contain",icon:me($e)},ORIGINAL:{name:"original",icon:me(Oe)}},d=st()?"DOMMouseScroll":"mousewheel",{t:F}=we(),i=he("image-viewer"),{nextZIndex:S}=Le(),g=L(),b=L([]),A=Te(),_=L(!0),f=L(l.initialIndex),B=Ne(u.CONTAIN),c=L({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),V=E(()=>{const{urlList:t}=l;return t.length<=1}),W=E(()=>f.value===0),j=E(()=>f.value===l.urlList.length-1),H=E(()=>l.urlList[f.value]),ae=E(()=>{const{scale:t,deg:n,offsetX:r,offsetY:k,enableTransition:x}=c.value;let C=r/t,$=k/t;switch(n%360){case 90:case-270:[C,$]=[$,-C];break;case 180:case-180:[C,$]=[-C,-$];break;case 270:case-90:[C,$]=[-$,C];break}const R={transform:`scale(${t}) rotate(${n}deg) translate(${C}px, ${$}px)`,transition:x?"transform .3s":""};return B.value.name===u.CONTAIN.name&&(R.maxWidth=R.maxHeight="100%"),R}),q=E(()=>de(l.zIndex)?l.zIndex:S());function T(){se(),s("close")}function ne(){const t=oe(r=>{switch(r.code){case D.esc:l.closeOnPressEscape&&T();break;case D.space:U();break;case D.left:J();break;case D.up:a("zoomIn");break;case D.right:Q();break;case D.down:a("zoomOut");break}}),n=oe(r=>{(r.wheelDelta?r.wheelDelta:-r.detail)>0?a("zoomIn",{zoomRate:1.2,enableTransition:!1}):a("zoomOut",{zoomRate:1.2,enableTransition:!1})});A.run(()=>{M(document,"keydown",t),M(document,d,n)})}function se(){A.stop()}function Z(){_.value=!1}function G(t){_.value=!1,t.target.alt=F("el.image.error")}function K(t){if(_.value||t.button!==0||!g.value)return;c.value.enableTransition=!1;const{offsetX:n,offsetY:r}=c.value,k=t.pageX,x=t.pageY,C=oe(R=>{c.value={...c.value,offsetX:n+R.pageX-k,offsetY:r+R.pageY-x}}),$=M(document,"mousemove",C);M(document,"mouseup",()=>{$()}),t.preventDefault()}function X(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function U(){if(_.value)return;const t=qe(u),n=Object.values(u),r=B.value.name,x=(n.findIndex(C=>C.name===r)+1)%t.length;B.value=u[t[x]],X()}function Y(t){const n=l.urlList.length;f.value=(t+n)%n}function J(){W.value&&!l.infinite||Y(f.value-1)}function Q(){j.value&&!l.infinite||Y(f.value+1)}function a(t,n={}){if(_.value)return;const{zoomRate:r,rotateDeg:k,enableTransition:x}={zoomRate:1.4,rotateDeg:90,enableTransition:!0,...n};switch(t){case"zoomOut":c.value.scale>.2&&(c.value.scale=Number.parseFloat((c.value.scale/r).toFixed(3)));break;case"zoomIn":c.value.scale<7&&(c.value.scale=Number.parseFloat((c.value.scale*r).toFixed(3)));break;case"clockwise":c.value.deg+=k;break;case"anticlockwise":c.value.deg-=k;break}c.value.enableTransition=x}return ie(H,()=>{be(()=>{const t=b.value[0];t!=null&&t.complete||(_.value=!0)})}),ie(f,t=>{X(),s("switch",t)}),ve(()=>{var t,n;ne(),(n=(t=g.value)==null?void 0:t.focus)==null||n.call(t)}),m({setActiveItem:Y}),(t,n)=>(p(),te(je,{to:"body",disabled:!t.teleported},[v(We,{name:"viewer-fade",appear:""},{default:I(()=>[y("div",{ref_key:"wrapper",ref:g,tabindex:-1,class:w(e(i).e("wrapper")),style:ce({zIndex:e(q)})},[y("div",{class:w(e(i).e("mask")),onClick:n[0]||(n[0]=Ae(r=>t.hideOnClickModal&&T(),["self"]))},null,2),z(" CLOSE "),y("span",{class:w([e(i).e("btn"),e(i).e("close")]),onClick:T},[v(e(O),null,{default:I(()=>[v(e(Be))]),_:1})],2),z(" ARROW "),e(V)?z("v-if",!0):(p(),h(P,{key:0},[y("span",{class:w([e(i).e("btn"),e(i).e("prev"),e(i).is("disabled",!t.infinite&&e(W))]),onClick:J},[v(e(O),null,{default:I(()=>[v(e(Re))]),_:1})],2),y("span",{class:w([e(i).e("btn"),e(i).e("next"),e(i).is("disabled",!t.infinite&&e(j))]),onClick:Q},[v(e(O),null,{default:I(()=>[v(e(De))]),_:1})],2)],64)),z(" ACTIONS "),y("div",{class:w([e(i).e("btn"),e(i).e("actions")])},[y("div",{class:w(e(i).e("actions__inner"))},[v(e(O),{onClick:n[1]||(n[1]=r=>a("zoomOut"))},{default:I(()=>[v(e(Me))]),_:1}),v(e(O),{onClick:n[2]||(n[2]=r=>a("zoomIn"))},{default:I(()=>[v(e(Fe))]),_:1}),y("i",{class:w(e(i).e("actions__divider"))},null,2),v(e(O),{onClick:U},{default:I(()=>[(p(),te(Ve(e(B).icon)))]),_:1}),y("i",{class:w(e(i).e("actions__divider"))},null,2),v(e(O),{onClick:n[3]||(n[3]=r=>a("anticlockwise"))},{default:I(()=>[v(e(He))]),_:1}),v(e(O),{onClick:n[4]||(n[4]=r=>a("clockwise"))},{default:I(()=>[v(e(Xe))]),_:1})],2)],2),z(" CANVAS "),y("div",{class:w(e(i).e("canvas"))},[(p(!0),h(P,null,ue(t.urlList,(r,k)=>Ye((p(),h("img",{ref_for:!0,ref:x=>b.value[k]=x,key:r,src:r,style:ce(e(ae)),class:w(e(i).e("img")),onLoad:Z,onError:G,onMousedown:K},null,46,rt)),[[Pe,k===f.value]])),128))],2),ee(t.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var ct=_e(ut,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const dt=ke(ct),ft=ye({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:re([String,Object])},previewSrcList:{type:re(Array),default:()=>ge([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),vt={load:o=>o instanceof Event,error:o=>o instanceof Event,switch:o=>de(o),close:()=>!0,show:()=>!0},mt=["src","loading"],pt={key:0},gt={name:"ElImage",inheritAttrs:!1},wt=fe({...gt,props:ft,emits:vt,setup(o,{emit:m}){const s=o;let l="";const{t:u}=we(),d=he("image"),F=Ze(),i=Ee(),S=L(),g=L(!1),b=L(!0),A=L(!1),_=L(),f=L(),B=N&&"loading"in HTMLImageElement.prototype;let c,V;const W=E(()=>F.style),j=E(()=>{const{fit:a}=s;return N&&a?{objectFit:a}:{}}),H=E(()=>{const{previewSrcList:a}=s;return Array.isArray(a)&&a.length>0}),ae=E(()=>{const{previewSrcList:a,initialIndex:t}=s;let n=t;return t>a.length-1&&(n=0),n}),q=E(()=>s.loading==="eager"?!1:!B&&s.loading==="lazy"||s.lazy),T=()=>{!N||(b.value=!0,g.value=!1,S.value=s.src)};function ne(a){b.value=!1,g.value=!1,m("load",a)}function se(a){b.value=!1,g.value=!0,m("error",a)}function Z(){nt(_.value,f.value)&&(T(),X())}const G=Je(Z,200);async function K(){var a;if(!N)return;await be();const{scrollContainer:t}=s;Ke(t)?f.value=t:Ue(t)&&t!==""?f.value=(a=document.querySelector(t))!=null?a:void 0:_.value&&(f.value=ze(_.value)),f.value&&(c=M(f,"scroll",G),setTimeout(()=>Z(),100))}function X(){!N||!f.value||!G||(c==null||c(),f.value=void 0)}function U(a){if(!!a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function Y(){!H.value||(V=M("wheel",U,{passive:!1}),l=document.body.style.overflow,document.body.style.overflow="hidden",A.value=!0,m("show"))}function J(){V==null||V(),document.body.style.overflow=l,A.value=!1,m("close")}function Q(a){m("switch",a)}return ie(()=>s.src,()=>{q.value?(b.value=!0,g.value=!1,X(),K()):T()}),ve(()=>{q.value?K():T()}),(a,t)=>(p(),h("div",{ref_key:"container",ref:_,class:w([e(d).b(),a.$attrs.class]),style:ce(e(W))},[S.value!==void 0&&!g.value?(p(),h("img",Ge({key:0},e(i),{src:S.value,loading:a.loading,style:e(j),class:[e(d).e("inner"),e(H)&&e(d).e("preview"),b.value&&e(d).is("loading")],onClick:Y,onLoad:ne,onError:se}),null,16,mt)):z("v-if",!0),b.value||g.value?(p(),h("div",{key:1,class:w(e(d).e("wrapper"))},[b.value?ee(a.$slots,"placeholder",{key:0},()=>[y("div",{class:w(e(d).e("placeholder"))},null,2)]):g.value?ee(a.$slots,"error",{key:1},()=>[y("div",{class:w(e(d).e("error"))},Ce(e(u)("el.image.error")),3)]):z("v-if",!0)],2)):z("v-if",!0),e(H)?(p(),h(P,{key:2},[A.value?(p(),te(e(dt),{key:0,"z-index":a.zIndex,"initial-index":e(ae),infinite:a.infinite,"url-list":a.previewSrcList,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:J,onSwitch:Q},{default:I(()=>[a.$slots.viewer?(p(),h("div",pt,[ee(a.$slots,"viewer")])):z("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):z("v-if",!0)],64)):z("v-if",!0)],6))}});var yt=_e(wt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const ht=ke(yt),bt=fe({name:"Search",components:{ElSpace:Qe,ElImage:ht},props:{key:{type:String,default:""}},setup(o,m){let s=et({imgList:[]}),l=u=>{var d=document.createElement("input");document.body.appendChild(d),d.value=u,d.select(),document.execCommand("copy",!1),d.remove(),le("\u5DF2\u7ECF\u590D\u5236")};return ve(()=>{Se({url:"http://wushusandavercel.com:5000/picBed",method:"get"}).then(u=>{u.code===0?s.imgList=u.data.map(d=>({url:`http://wushusandavercel.com:5000/images/picBed/${d.filename}`,tags:d.tags})):le({message:u.message,type:"error"})}).catch(u=>{le({message:"\u8BF7\u6C42\u5931\u8D25",type:"error"})})}),{temp:s,liClickHandler:l}}});const _t=["onClick"];function kt(o,m,s,l,u,d){const F=pe("el-image"),i=pe("el-space");return p(),h("main",null,[y("section",null,[v(i,{wrap:""},{default:I(()=>[(p(!0),h(P,null,ue(o.temp.imgList,(S,g)=>(p(),te(F,{class:"img",key:g,fit:"cover",src:S.url},null,8,["src"]))),128))]),_:1})]),y("aside",null,[y("ul",null,[(p(!0),h(P,null,ue(o.temp.imgList,(S,g)=>(p(),h("li",{key:g,onClick:b=>o.liClickHandler(S.url)},Ce(S.url),9,_t))),128))])])])}const Lt=tt(bt,[["render",kt],["__scopeId","data-v-9230674d"]]);export{Lt as default};
