# 编写可维护的 javascript

> 原著：Maintainable Javascritp
> 这是在一次与同事合作时，从代码可规范聊到了这本书。他的前老大是译者。
> 中文版本只有 200+页。一会儿就看完了。
> 作者: Nicbolas C.Zakas
> 译者：李晶 郭凯 张散集
> 你的团队编程可以从狭义的个人偏好的阴霾中走出来，走向真正的高效能和高水准。

# 第一部分 编程风格

> 程序是写给人读的，只是偶尔让计算机执行一下。————Donald Knuth

风格一致的重要性：

- 减少理解代码逻辑的成本。
- 减少重新排版。

格式化工具：

- JSLint 可发现代码的潜在错误。
- JSHint

## 基本的格式化

- 缩进层级。在 2 个空格、4 个空格、8 个空格中选择了了 4 个空格。
- 语句结尾是否有;。ASI（Automatic Semicolon Insertion）可以使 js 省略分号也能正常工作。作者推荐有分号。
- 行的长度。最长不过 80 个字符。（源于很久前的文本编辑器）。有几个选项。<=70/<=100/<=80/<=79
- 空行。用空行分隔不相关的代码。方法之间、局部变量与第一条语句之间、多行或单行注释之间、方法与注释之间
- 命名。驼峰式。匈牙利命名法。
  - 动词
    - can 返回一个 boolean
    - has 返回一个 boolean
    - is 返回一个 boolean
    - get 取一个值
    - set 存一个值
- 常量。全大写。
- 构造函数。大驼峰命名。

### 直接量

字符串
数字
null 使用场景如下：

- 初始化一个变量。
- 与已经初始化的变量比较。
- 当函数的参数期望是对象时，用作参数传入。
- 当函数的返回值期望是对象时，用作返回值返回。
  不使用场景如下：
- 不使用 null 检测是否传入指定参数。
- 不使用 null 检测是否初始化变量。
  undefined
  对象直接量（直接写出对象的所有属性）

```
let book = {
    title: 'str',
    author: 'str',
}
// 反对使用下面的写法
let book = new Object()
book.title = 'str'
book.author = 'str'
```

数组直接量

```
let arr = [1, 2, 3]
// 反对使用下面的写法
let arr = new Array(1, 2, 3, 4)
```

## 注释

单行注释
多行注释

```
// 单行注释
/*
多行注释
*/
```

单行注释不应当以连续多行注释的形式出现，注释多行时应该使用多行注释。
注释前要有空行
使用注释的场景：

- 难于理解的代码
- 可能被误认为错误的代码
- 浏览器特性 hack
  文档注释

```
/** 该方法的功能
@method fn         方法的说明
@param  one string 参数一的说明
@param  two number 参数二的说明
@return     object 返回值的说明
**/
```

## 语句和表达式

编程分格:

- Dojo 编程风格
- Crockford 编程风格
-
-

```
// Dojo编程风格
if(condition){
    ....
}
// Crockford编程风格
if (condition) {
    ....
}
// jQuery采用此风格编程
if ( condition ) {
    ....
}
```

with 语句
可以改变包含上下文解析变量的方式。通过 with 可以直接使用局部变量和函数的形式来访问特定对象内的属性和方法。如下：

```
let book = {
    title: 'str',
    author: 'str',
}
let msg = 'str'
with (book) {
    msg += title
    msg += author
}
```

```
// for-in
for (let k in obj) { // k包含了从原型对象上的属性。
    if (obj.hasOwnProperty(k)) { // 只取当前对象的属性
        ...
    }
}
```

## 变量、函数和运算符

js 编程的本质是编写一个个的函数来完成任务，在函数内部，变量和运算符可以通过移动操作字节来使某件事发生。因此在讨论过基本的 js 书写格式后，接下来关注如何使用函数、变量和运算符来减少复杂度各增强可读性就显得十分重要了。
变量声明：
var 可使变量提升
总是将局部变量定义放在函数内第一条语句。

# 第二部分 编程实践

## UI 层的松耦合

## 避免使用全局变量

## 事件处理

## 避免“空比较”

## 将配置数据从代码中分离出来

## 抛出自定义错误

## 不是你的对象不要动

## 浏览器嗅探

# 第三部分 自动化

## 文件和目录结构

## Ant

## 校验

## 文件合并和加工

## 文件精简和压缩

## 文档化

## 自动化测试

## 组装在一起

# 附录 A Javascript 编程风格指南

# 附录 B Javascript 工具集
