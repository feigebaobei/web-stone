<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>


    </style>
  </head>
  <body>
    <button onclick="btClickHandler()">click button</button>
    <script src="https://unpkg.com/rxjs@7.8.1/dist/bundles/rxjs.umd.min.js"></script>
    <script>
      let clog = console.log
      // class Observable {
      //   constructor(fn) {
      //     this.fn = fn
      //     this.subscriber = new Subscriber(this)
      //   }
      //   subscribe(cb) {
      //     this.cb = cb
      //     this.fn(this.subscriber)
      //     return {
      //       unsubscribe: () => {
      //         this.subscriber.unsubscribe()
      //         // this.fn = () => {}
      //       }
      //     }
      //   }
      // }
      // class Subscriber {
      //   constructor(observable) {
      //     this.observable = observable
      //     this.status = 1
      //     // 1 订阅
      //     // 10 出错
      //     // 20 完成
      //   }
      //   next(x) {
      //     switch(this.status) {
      //       case 1:
      //         this.observable.cb(x)
      //     }
      //   }
      //   error() {
      //     this.status = 10
      //   }
      //   complete() {
      //     this.status = 20
      //   }
      //   unsubscribe() {
      //     this.complete()
      //   }
      // }
      // let ob = new Observable((sub) => {
      //   sub.next('hi')
      //   sub.next('hi1')
      //   sub.next('hi2')
      //   sub.next('hi3')
      //   setTimeout(() => {
      //     sub.next('hi4')
      //   }, 1000)
      // })
      // let obj = ob.subscribe((x) => {
      //   clog(x)
      // })
      // obj.unsubscribe()
      // let btClickHandler = () => {
      //   clog('lss')
      //   ob.subscribe((x) => {
      //     clog(x)
      //   })
      // }


      let observable = new Observable((subscribe) => {
        subscribe.next('boy')
      })
      observable.subscribe((x) => {
        clog('x', x)
      })
    </script>
  </body>
</html>

<!--
  功能
  1. 发布订阅功能
  2. 取消订阅
  3. next/error/complete
  
 -->